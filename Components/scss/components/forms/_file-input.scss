@use "sass:map";
@use "../../abstracts/tokens" as tokens;

// ============================
// Semantic variants
// ============================
@mixin file-input-variant($variant) {
  --border-color: map.get(map.get(tokens.$input-colors, $variant), border);
  --focus-color: map.get(map.get(tokens.$input-colors, $variant), focus);
}

.file-input.default   { @include file-input-variant(default); }
.file-input.success   { @include file-input-variant(success); }
.file-input.error     { @include file-input-variant(destructive); }

// ============================
// Upload block
// ============================
.upload-block {
  &__title {
    margin-bottom: var(--spacing-16);
    font-weight: 600;
  }

  &__label {
    font-weight: 600;
  }

  &__info {
    font-size: var(--text-body-sm-font-size);
    color: var(--gray-400);
    margin-bottom: var(--spacing-12);
  }

  &__control {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-12);
  }

  &__input {
    display: none;
  }

  &__button {
    width: fit-content;
    cursor: pointer;
  }

  &__list {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-8);
    margin-top: var(--spacing-12)
  }

  &__description {
    color: var(--gray-400);
    font-size: var(--text-body-md-font-size);
    line-height: 1.5;
    margin-top: var(--spacing-16);
  }


}

// ============================
// Upload list items
// ============================
.upload {
  &__item {
    display: flex;
    align-items: center;
    gap: var(--spacing-12);
    padding: var(--spacing-6) var(--spacing-12);

    background: var(--gray-100); 
    border: var(--border-width-1-5) var(--border-style-solid) transparent;
    border-radius: var(--border-radius-8);

    &--error {
      border-color: var(--red-600);
    }
  }

  &__thumb {
    width: 32px;
    height: 32px;
    border-radius: var(--radius-6);
    background: var(--gray-200);
    overflow: hidden;

    display: flex;
    align-items: center;
    justify-content: center;

    font-size: 11px;
    font-weight: 600;
    color: var(--gray-600);
    text-transform: uppercase;

    &--image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  }

  &__info {
    flex: 1;
    min-width: 0; 
    font-size: var(--text-body-sm-font-size);
    color: var(--gray-500); 
    display: flex;
    flex-wrap: nowrap;
    align-items: center;
    gap: var(--spacing-6);
  }

  &__file-name {
    display: block;
    max-width: 100%;

    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;

    color: var(--black);
    font-weight: 500;
    line-height: 1.2;
  }

  &__file-size {
    white-space: nowrap;
  }

  &__remove {
    background: none;
    border: none;
    cursor: pointer;
    padding: var(--spacing-4);
    color: var(--gray-600);

    &:hover {
      color: var(--gray-900);
    }

    &:focus-visible {
      outline: 2px solid var(--focus-color);
      outline-offset: 2px;
    }
  }

  &__upload {
    position: relative;
    background-color: transparent;
    border: none;
    height: var(--spacing-20);
    width: var(--spacing-20);

    &::after {
      content: '';
      position: absolute; 

      width: var(--spacing-12);
      height: var(--spacing-12);

      border-radius: 50%;
      border: 2px solid var(--blue-sky-600);
      border-right-color: transparent;

      top:0;
      right: 0;

      transform: translate(-50%, -50%);
      animation: spin 0.75s linear infinite;
    }

    svg {
      display: none;
    }
  }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.dropzone {
  border: 2px dashed var(--gray-300);
  border-radius: var(--border-radius-8);
  padding: var(--spacing-24);
  text-align: center;
  cursor: pointer;
  background-color: var(--white);

  transition: border-color 0.2s, background-color 0.2s;

  &:hover {
    border-color: var(--blue-sky-600);
  }

  &:active {
    background-color: var(--blue-sky-100)
  }

  &:focus {
        outline: 2px solid var(--white, #ffffff);
    box-shadow: 0 0 0 4px var(--focus-ring, var(--blue-sky-500, #3379DB));
  }

  &__content {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-8);
    align-items: center;
    justify-content: center;
    color: var(--gray-600);
  }

  &__link {
    color: var(--blue-sky-600);
    cursor: pointer;
    font-weight: 500;
    text-decoration: underline;
  }

  &:hover {
    background-color: var(--gray-50);
  }

  &--active {
    border-color: var(--blue-sky-600);
    background-color: var(--blue-sky-50);
  }

  &__details {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: var(--spacing-12);
  }
}
